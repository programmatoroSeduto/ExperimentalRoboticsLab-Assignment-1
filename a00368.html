<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RCL - RoboCLuedo: RoboCLuedo &ndash; SEQ &ndash; UML Sequence Diagrams</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="cluedologo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RCL - RoboCLuedo
   &#160;<span id="projectnumber">v1.0</span>
   </div>
   <div id="projectbrief">Francesco Ganci - S4143910 - Experimental Robotics Lab - Assignment 1</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a00368.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">RoboCLuedo &ndash; SEQ &ndash; UML Sequence Diagrams </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The UML Sequence Diagrams on a practical case</p>
<h1><a class="anchor" id="autotoc_md2"></a>
UML Sequence Diagrams - A practical example</h1>
<p>In order to show you how the project works I think it is more useful to present you a possible log from the project, using this test configuration:</p>
<ul>
<li>the item lists are reduced to only two elements per list.<ul>
<li>PLACE: bathroom, study.</li>
<li>PERSON: plum, mustard.</li>
<li>WEAPON: revolver, dagger.</li>
</ul>
</li>
<li>the maximum number of IDs is 4</li>
</ul>
<p>You can find both the log and the end ontology from the folder <a href="https://github.com/programmatoroSeduto/ExperimentalRoboticsLab-Assignment-1/tree/main/robocluedo/logs/test_20211109"><code>/logs/test_20211109</code></a>. In this example, the program was launched using the main launch file, that suppresses some logs, for example the ones from the cluedo_armor_interface. Only the logs belonging to the oracle and the <a class="el" href="a00207.html">robocluedo_main</a> node are visible, since I think they're the most relevant nodes in the architecture.</p>
<p>Before starting, all the secundary components start running, and the config files are loaded.</p>
<div class="fragment"><div class="line">[ INFO] [1636487503.092018000]: [cluedo_oracle] reading from fiile [/root/ws_experimental_robotics_lab_assignment_1/src/ExperimentalRoboticsLab-Assignment-1/robocluedo/config/cluedo_items/cluedo_who.txt] </div>
<div class="line">[ INFO] [1636487503.092848100]: [cluedo_oracle] line[1] READ [plum] </div>
<div class="line">[ INFO] [1636487503.092901500]: [cluedo_oracle] line[2] READ [mustard] </div>
<div class="line">[ INFO] [1636487503.092950600]: [cluedo_oracle] closing file ...</div>
<div class="line">[ INFO] [1636487503.093006600]: [cluedo_oracle] reading from fiile [/root/ws_experimental_robotics_lab_assignment_1/src/ExperimentalRoboticsLab-Assignment-1/robocluedo/config/cluedo_items/cluedo_where.txt] </div>
<div class="line">[ INFO] [1636487503.093062800]: [cluedo_oracle] line[1] READ [study] </div>
<div class="line">[ INFO] [1636487503.093111100]: [cluedo_oracle] line[2] READ [bathroom] </div>
<div class="line">[ INFO] [1636487503.093157200]: [cluedo_oracle] closing file ...</div>
<div class="line">[ INFO] [1636487503.093205400]: [cluedo_oracle] reading from fiile [/root/ws_experimental_robotics_lab_assignment_1/src/ExperimentalRoboticsLab-Assignment-1/robocluedo/config/cluedo_items/cluedo_what.txt] </div>
<div class="line">[ INFO] [1636487503.093260300]: [cluedo_oracle] line[1] READ [dagger] </div>
<div class="line">[ INFO] [1636487503.093305700]: [cluedo_oracle] line[2] READ [revolver] </div>
<div class="line">[ INFO] [1636487503.093352000]: [cluedo_oracle] closing file ...</div>
</div><!-- fragment --><p>In particular the Oracle prepares the case and chooses the solution. In this case, the generated solution has ID zero, and we know what is from the log:</p>
<div class="fragment"><div class="line">        ...</div>
<div class="line">[ INFO] [1636487503.093892400]: [cluedo_oracle] found a max number of hypotheses: 4</div>
<div class="line">[ INFO] [1636487503.093940200]: [cluedo_oracle] case generation started </div>
<div class="line">[ INFO] [1636487503.093992500]: [cluedo_oracle] the solution is (where:study, who:mustard, what:dagger)</div>
<div class="line">[ INFO] [1636487503.094038100]: [cluedo_oracle] the solution has ID:0</div>
<div class="line">[ INFO] [1636487503.094091800]: [cluedo_oracle] hints generation finished. Generated: 19 hints</div>
</div><!-- fragment --><p>The main node waits for the services and the topics, until all the nodes are ready.</p>
<div class="fragment"><div class="line">        ...</div>
<div class="line">[ INFO] [1636487503.094138700]: [cluedo_oracle] subscribing to the topic [/hint_signal] ...</div>
<div class="line">[ INFO] [1636487503.095897700]: [cluedo_oracle] subscribing to the topic [/hint_signal] ... OK</div>
<div class="line">[ INFO] [1636487503.095975500]: [cluedo_oracle] Creating publisher [/hint] ...</div>
<div class="line">[ INFO] [1636487503.097834100]: [cluedo_oracle] Creating publisher [/hint] ... OK</div>
<div class="line">[ INFO] [1636487503.097998500]: [cluedo_oracle] Advertising service [/check_solution] ...</div>
<div class="line">[ INFO] [1636487503.099094600]: [cluedo_oracle] Advertising service [/check_solution] ... OK</div>
<div class="line">[ INFO] [1636487503.099201000]: [cluedo_oracle] ready!</div>
<div class="line">log4j:WARN No appenders could be found for logger (org.ros.internal.node.client.Registrar).</div>
<div class="line">log4j:WARN Please initialize the log4j system properly.</div>
<div class="line">log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.</div>
<div class="line">[INFO] [1636487503.802970]: [robocluedo_main] calling service /go_to ...</div>
<div class="line">[INFO] [1636487503.804739]: [robocluedo_main] OK</div>
<div class="line">[INFO] [1636487503.805391]: [robocluedo_main] calling service /random_room ...</div>
<div class="line">[INFO] [1636487503.806928]: [robocluedo_main] OK</div>
<div class="line">[INFO] [1636487503.807626]: [robocluedo_main] subscribing to /hint ...</div>
<div class="line">[INFO] [1636487503.809300]: [robocluedo_main] OK</div>
<div class="line">[INFO] [1636487503.810581]: [robocluedo_main] calling service /check_solution ...</div>
<div class="line">[INFO] [1636487503.812781]: [robocluedo_main] OK</div>
<div class="line">[INFO] [1636487503.813683]: [robocluedo_main] calling service /cluedo_armor/add_hint ...</div>
<div class="line">[INFO] [1636487504.719390]: [robocluedo_main] OK</div>
<div class="line">[INFO] [1636487504.720344]: [robocluedo_main] calling service /cluedo_armor/find_consistent_h ...</div>
<div class="line">[INFO] [1636487504.722123]: [robocluedo_main] OK</div>
<div class="line">[INFO] [1636487504.722945]: [robocluedo_main] calling service /cluedo_armor/wrong_hypothesis ...</div>
<div class="line">[INFO] [1636487504.724579]: [robocluedo_main] OK</div>
<div class="line">[INFO] [1636487504.725292]: [robocluedo_main] asking for service [/cluedo_armor/backup] ...</div>
<div class="line">[INFO] [1636487504.726978]: [robocluedo_main] OK!</div>
</div><!-- fragment --><p>When all the nodes are ready, the robot can start moving.</p>
<div class="fragment"><div class="line">        ...</div>
<div class="line">[INFO] [1636487504.730808]: [robocluedo_main] starting the FSM...</div>
<div class="line">[INFO] [1636487504.731578]: State machine starting in initial state &#39;robocluedo_random_target&#39; with userdata: </div>
<div class="line">    []</div>
</div><!-- fragment --><p>Here is a representation of what happened up to now:</p>
<div class="image">
<img src="UML_sequence_example_loading.png" alt=""/>
<div class="caption">
UML sequence loading</div></div>
   <p>At the beginning, the robot has no informations: the ontology is empty, so it chooses randomly a room asking to the node cluedo_random_room in search of clues. Each time it enteres in one room, it receives <em>at most</em> one hint, or also nothing in some cases. The robot keeps behave in this way until at least one hypothesis becomes complete. In the following piece of log, the typical job of the robot while is looking for clues:</p>
<div class="fragment"><div class="line">        ...</div>
<div class="line">[INFO] [1636487510.302336]: [state:random_target] actual position: bathroom | random target: bathroom</div>
<div class="line">[INFO] [1636487510.303734]: State machine transitioning &#39;robocluedo_random_target&#39;:&#39;move_robot&#39;--&gt;&#39;robocluedo_moving&#39;</div>
<div class="line">[ INFO] [1636487511.307296200]: [cluedo_oracle] publishing hint (ID:0, PROP:who, VALUE:mustard)</div>
<div class="line">[INFO] [1636487511.307459]: [state:moving] reached position: bathroom </div>
<div class="line">[INFO] [1636487511.308630]: State machine transitioning &#39;robocluedo_moving&#39;:&#39;target_reached_no_charge&#39;--&gt;&#39;robocluedo_listening_for_hints&#39;</div>
<div class="line">[INFO] [1636487511.309457]: [state:listening_for_hints] received a hint</div>
<div class="line">[INFO] [1636487511.310390]: State machine transitioning &#39;robocluedo_listening_for_hints&#39;:&#39;received_a_hint&#39;--&gt;&#39;robocluedo_update_ontology&#39;</div>
<div class="line">[INFO] [1636487511.311347]: [state:update_ontology] received hint: HP0(who:mustard)</div>
<div class="line">[INFO] [1636487511.379564]: [state:update_ontology] writing backup of the ontology...</div>
<div class="line">[INFO] [1636487511.412380]: [state:update_ontology] ontology saved</div>
<div class="line">[INFO] [1636487511.413624]: State machine transitioning &#39;robocluedo_update_ontology&#39;:&#39;done&#39;--&gt;&#39;robocluedo_reasoning&#39;</div>
<div class="line">[INFO] [1636487511.432874]: State machine transitioning &#39;robocluedo_reasoning&#39;:&#39;no_consistent_hp&#39;--&gt;&#39;robocluedo_random_target&#39;</div>
</div><!-- fragment --><p>A representation of what is happening in the common cycle above mentioned. The worst case scenario is assumed.</p>
<div class="image">
<img src="UML_sequence_example_working_cycle.png" alt=""/>
<div class="caption">
UML sequence working cycle</div></div>
   <p>In the example, there are no wrong charges unfortunately, but it is reasonable to suppose that, on a more complex setup (many elements in the list, many IDs, ...) the robot could fail sometimes. Here is the final piece of the log, which shows how the robot behaves when it is ready to present a charge.</p>
<div class="fragment"><div class="line">        ...</div>
<div class="line">[INFO] [1636487535.449865]: State machine transitioning &#39;robocluedo_reasoning&#39;:&#39;no_consistent_hp&#39;--&gt;&#39;robocluedo_random_target&#39;</div>
<div class="line">[INFO] [1636487535.452961]: [state:random_target] actual position: study | random target: bathroom</div>
<div class="line">[INFO] [1636487535.453893]: State machine transitioning &#39;robocluedo_random_target&#39;:&#39;move_robot&#39;--&gt;&#39;robocluedo_moving&#39;</div>
<div class="line">[ INFO] [1636487536.456438300]: [cluedo_oracle] publishing hint (ID:0, PROP:where, VALUE:study)</div>
<div class="line">[INFO] [1636487536.456450]: [state:moving] reached position: bathroom </div>
<div class="line">[INFO] [1636487536.458016]: State machine transitioning &#39;robocluedo_moving&#39;:&#39;target_reached_no_charge&#39;--&gt;&#39;robocluedo_listening_for_hints&#39;</div>
<div class="line">[INFO] [1636487536.459015]: [state:listening_for_hints] received a hint</div>
<div class="line">[INFO] [1636487536.459973]: State machine transitioning &#39;robocluedo_listening_for_hints&#39;:&#39;received_a_hint&#39;--&gt;&#39;robocluedo_update_ontology&#39;</div>
<div class="line">[INFO] [1636487536.460861]: [state:update_ontology] received hint: HP0(where:study)</div>
<div class="line">[INFO] [1636487536.473777]: [state:update_ontology] writing backup of the ontology...</div>
<div class="line">[INFO] [1636487536.494515]: [state:update_ontology] ontology saved</div>
<div class="line">[INFO] [1636487536.496134]: State machine transitioning &#39;robocluedo_update_ontology&#39;:&#39;done&#39;--&gt;&#39;robocluedo_reasoning&#39;</div>
<div class="line">[INFO] [1636487536.513820]: [state:reasoning] complete hypotheses found: 1</div>
</div><!-- fragment --><p>If the number of hypotheses would have been 2, the robot have been choosen randomly from the available ones. Here there's only one hypothesis, and it will be so every time because the robot "thinks" every time it enters in a room, and at most one hint can be sent to the robot: if the oracle would send more than one hint at time, the robot have had ore elements to elaborate.</p>
<p>The actual position is not the one mentioned in the hypothesis, so the robot first moves towards the room, and when is there, makes the charge. The solution is correct, so the program ends.</p>
<div class="fragment"><div class="line">[INFO] [1636487536.515209]: [state:reasoning] HP0(who:mustard, where:study, what:dagger)</div>
<div class="line">[INFO] [1636487536.516173]: [state:reasoning] selected hyp. with tag: HP0 | actual position: bathroom</div>
<div class="line">[INFO] [1636487536.517029]: State machine transitioning &#39;robocluedo_reasoning&#39;:&#39;not_in_the_right_place&#39;--&gt;&#39;robocluedo_moving&#39;</div>
<div class="line">[ INFO] [1636487537.519778200]: [cluedo_oracle] publishing hint (ID:1, PROP:what, VALUE:revolver)</div>
<div class="line">[INFO] [1636487537.519989]: [state:moving] reached position: study </div>
<div class="line">[INFO] [1636487537.521567]: State machine transitioning &#39;robocluedo_moving&#39;:&#39;target_reached_ready_for_charge&#39;--&gt;&#39;robocluedo_charge&#39;</div>
<div class="line">[INFO] [1636487537.522649]: [state:charge] asking to the oracle: (who:mustard, where:study, what:dagger)</div>
<div class="line">[ INFO] [1636487537.524821900]: [cluedo_oracle] evaluating the solution WHERE[study]  WHO [mustard]  WHAT [dagger] </div>
<div class="line">[ INFO] [1636487537.524905900]: [cluedo_oracle] SUCCESS! Found the solution. </div>
<div class="line">[INFO] [1636487537.525135]: [state:charge] mystery solved!</div>
<div class="line">[INFO] [1636487537.526102]: State machine terminating &#39;robocluedo_charge&#39;:&#39;case_solved&#39;:&#39;mystery_solved&#39;</div>
</div><!-- fragment --><p>The last part of the log can be resumed with this diagram:</p>
<div class="image">
<img src="UML_sequence_example_final.png" alt=""/>
<div class="caption">
UML sequence working cycle</div></div>
   <p>This was a very simple example, aimed at make you understand how this project works. Inside the directory <em>logs</em> you can find some more interesting examples with the default setup. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="a00369.html">UML Diagrams</a></li>
    <li class="footer">Generated on Wed Nov 10 2021 11:27:54 for RCL - RoboCLuedo by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
